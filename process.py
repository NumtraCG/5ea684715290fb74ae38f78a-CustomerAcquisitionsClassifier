import json
import Connectors
import Transformations
import AutoML
try:
    CustomerAcquisitionsClassifier_DBFS = Connectors.DBFSConnector.fetch(
        [], {}, "5ea684715290fb74ae38f78b", spark, "{'url': '/Demo/CustomerAcquisitionTrain.csv', 'file_type': 'Delimeted', 'dbfs_token': 'dapib8073bbfa952efa9d363b234ce06e2c6', 'dbfs_domain': 'westus.azuredatabricks.net', 'delimiter': ',', 'is_header': 'Use Header Line'}")

except Exception as ex:
    print(ex)
try:
    CustomerAcquisitionsClassifier_AutoFE = Transformations.TransformationMain.run(["5ea684715290fb74ae38f78b"], {"5ea684715290fb74ae38f78b": CustomerAcquisitionsClassifier_DBFS}, "5ea684715290fb74ae38f78c", spark, json.dumps({"FE": [{"transformationsData": {"feature_label": "City"}, "feature": "City", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "ARVADA", "max": "WHEAT RIDGE", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Product_Category"}, "feature": "Product_Category", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "Furniture", "max": "Technology", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Product_Sub-Category"}, "feature": "Product_Sub-Category", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "Appliances", "max": "Telephones and Communication", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Count", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "1.08", "stddev": "0.3", "min": "1", "max": "4", "missing": "0"}}, {"transformationsData": {}, "feature": "Customer ID", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "1755.99", "stddev": "967.54", "min": "2", "max": "3394", "missing": "0"}}, {"transformationsData": {}, "feature": "Store Number", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "102.41", "stddev": "1.81", "min": "100", "max": "105", "missing": "0"}}, {"transformationsData": {"feature_label": "Customer Segment"}, "feature": "Customer Segment", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "Consumer", "max": "Small Business", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "First Name"}, "feature": "First Name", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "ADXXXX", "max": "ZEXXX", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Last Name"}, "feature": "Last Name", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "ABXXXXX", "max": "ZIXXXXXXX", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "Address"}, "feature": "Address", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "10 S SHERMAN ST", "max": "9924 W ARLINGTON AVE", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "State"}, "feature": "State", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "CO", "max": "CO", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Zip", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "80112.82", "stddev": "103.86", "min": "80002", "max": "80602", "missing": "0"}}, {"transformationsData": {}, "feature": "DriveTime", "type": "real", "selected": "True", "replaceby": "mean", "stats": {"count": "987", "mean": "12.91", "stddev": "7.33", "min": "0.91", "max": "30.0", "missing": "0"}, "transformation": ""}, {"transformationsData": {}, "feature": "Length of Residense", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "10.55", "stddev": "10.56", "min": "0", "max": "55", "missing": "0"}}, {"transformationsData": {}, "feature": "MOR BANK: UPSCALE MERCHANDISE BUYER", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "0.01", "stddev": "0.1", "min": "0", "max": "1", "missing": "0"}}, {"transformationsData": {"feature_label": "MOSAIC HOUSEHOLD"}, "feature": "MOSAIC HOUSEHOLD", "type": "string", "selected": "True", "replaceby": "max", "stats": {
                                                                                   "count": "987", "mean": "", "stddev": "", "min": "A01", "max": "U00", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "MOSAIC DESCRIPTION"}, "feature": "MOSAIC DESCRIPTION", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "Aspirational Fusion", "max": "Young City Solos", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "Customer_Lon", "type": "real", "selected": "True", "replaceby": "mean", "stats": {"count": "987", "mean": "-104.92", "stddev": "0.12", "min": "-105.226518", "max": "-104.65312", "missing": "0"}, "transformation": ""}, {"transformationsData": {}, "feature": "Customer_Lat", "type": "real", "selected": "True", "replaceby": "mean", "stats": {"count": "987", "mean": "39.7", "stddev": "0.09", "min": "39.485121", "max": "39.998058", "missing": "0"}, "transformation": ""}, {"transformationsData": {}, "feature": "Store ID", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "987", "mean": "102.41", "stddev": "1.81", "min": "100", "max": "105", "missing": "0"}}, {"transformationsData": {}, "feature": "Store_Lon", "type": "real", "selected": "True", "replaceby": "mean", "stats": {"count": "987", "mean": "-104.92", "stddev": "0.12", "min": "-105.077754", "max": "-104.717928", "missing": "0"}, "transformation": ""}, {"transformationsData": {}, "feature": "Store_Lat", "type": "real", "selected": "True", "replaceby": "mean", "stats": {"count": "987", "mean": "39.7", "stddev": "0.08", "min": "39.565799", "max": "39.856274", "missing": "0"}, "transformation": ""}, {"transformationsData": {"feature_label": "Channel"}, "feature": "Channel", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "987", "mean": "", "stddev": "", "min": "Catalog", "max": "eCommerce", "missing": "0"}, "transformation": "String Indexer"}, {"feature": "City_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "1.67", "stddev": "2.4", "min": "0.0", "max": "17.0", "missing": "0"}}, {"feature": "Product_Category_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "987", "mean": "0.62", "stddev": "0.79", "min": "0", "max": "2", "missing": "0"}}, {"feature": "Product_Sub-Category_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "5.15", "stddev": "4.34", "min": "0.0", "max": "16.0", "missing": "0"}}, {"feature": "Customer Segment_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "987", "mean": "1.27", "stddev": "1.13", "min": "0", "max": "3", "missing": "0"}}, {"feature": "First Name_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "70.74", "stddev": "66.88", "min": "0.0", "max": "267.0", "missing": "0"}}, {"feature": "Last Name_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "124.07", "stddev": "113.09", "min": "0.0", "max": "409.0", "missing": "0"}}, {"feature": "Address_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "262.02", "stddev": "204.83", "min": "0.0", "max": "681.0", "missing": "0"}}, {"feature": "State_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "987", "mean": "0.0", "stddev": "0.0", "min": "0", "max": "0", "missing": "0"}}, {"feature": "MOSAIC HOUSEHOLD_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "15.2", "stddev": "13.11", "min": "0.0", "max": "55.0", "missing": "0"}}, {"feature": "MOSAIC DESCRIPTION_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "987", "mean": "5.72", "stddev": "4.54", "min": "0.0", "max": "19.0", "missing": "0"}}, {"feature": "Channel_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "987", "mean": "0.5", "stddev": "0.68", "min": "0", "max": "2", "missing": "0"}}]}))

except Exception as ex:
    print(ex)
try:
    AutoML.functionClassification(CustomerAcquisitionsClassifier_AutoFE, ["City", "Product_Category", "Product_Sub-Category", "Count", "Customer ID", "Store Number", "Customer Segment", "First Name", "Last Name", "Address",
                                                                          "State", "Zip", "DriveTime", "Length of Residense", "MOR BANK: UPSCALE MERCHANDISE BUYER", "MOSAIC HOUSEHOLD", "MOSAIC DESCRIPTION", "Customer_Lon", "Customer_Lat", "Store ID", "Store_Lon", "Store_Lat"], "Channel")

except Exception as ex:
    print(ex)
